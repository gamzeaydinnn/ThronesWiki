<!DOCTYPE html>
<html lang="tr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sohbet - ThronesWiki</title>
    <link rel="stylesheet" href="../static/style.css">
    <link rel="stylesheet" href="../static/chat.css">
    <link rel="stylesheet" href="../static/chatbot.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body class="chat-page">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <span class="logo-icon">âš”ï¸</span>
                <span class="logo-text">ThronesWiki</span>
            </a>
            <ul class="nav-links">
                <li><a href="index.html">Ana Sayfa</a></li>
                <li><a href="index.html#characters">Karakterler</a></li>
                <li><a href="index.html#houses">Haneler</a></li>
                <li><a href="chat.html" class="active">Sohbet</a></li>
            </ul>
            <div class="nav-auth">
                <!-- Thymeleaf: GiriÅŸ yapmÄ±ÅŸ kullanÄ±cÄ± -->
                <div class="user-menu" th:if="${currentUser}">
                    <span class="user-avatar">ğŸ‘¤</span>
                    <span class="user-name" th:text="${currentUser.username}">KullanÄ±cÄ±</span>
                    <a href="/logout" class="btn btn-outline btn-sm">Ã‡Ä±kÄ±ÅŸ</a>
                </div>
                <!-- GiriÅŸ yapmamÄ±ÅŸ kullanÄ±cÄ± -->
                <div th:unless="${currentUser}">
                    <a href="login.html" class="btn btn-outline">GiriÅŸ Yap</a>
                    <a href="register.html" class="btn btn-primary">KayÄ±t Ol</a>
                </div>
            </div>
            <button class="mobile-menu-btn" id="mobileMenuBtn">â˜°</button>
        </div>
    </nav>

    <!-- Chat Container -->
    <main class="chat-container">
        <!-- Sidebar - Chat Rooms & Users -->
        <aside class="chat-sidebar">
            <div class="sidebar-header">
                <h2>ğŸ’¬ Sohbet OdalarÄ±</h2>
            </div>
            
            <!-- Chat Rooms -->
            <div class="chat-rooms">
                <h3 class="sidebar-section-title">Odalar</h3>
                <ul class="room-list">
                    <li class="room-item active" data-room="genel">
                        <span class="room-icon">ğŸ°</span>
                        <div class="room-info">
                            <span class="room-name">Genel Sohbet</span>
                            <span class="room-desc">Herkesin katÄ±labileceÄŸi ana oda</span>
                        </div>
                        <span class="room-badge">24</span>
                    </li>
                    <li class="room-item" data-room="teoriler">
                        <span class="room-icon">ğŸ”®</span>
                        <div class="room-info">
                            <span class="room-name">Teoriler</span>
                            <span class="room-desc">Fan teorileri tartÄ±ÅŸma odasÄ±</span>
                        </div>
                        <span class="room-badge">12</span>
                    </li>
                    <li class="room-item" data-room="stark">
                        <span class="room-icon">ğŸº</span>
                        <div class="room-info">
                            <span class="room-name">Stark HayranlarÄ±</span>
                            <span class="room-desc">KÄ±ÅŸ geliyor!</span>
                        </div>
                        <span class="room-badge">8</span>
                    </li>
                    <li class="room-item" data-room="targaryen">
                        <span class="room-icon">ğŸ‰</span>
                        <div class="room-info">
                            <span class="room-name">Targaryen HayranlarÄ±</span>
                            <span class="room-desc">AteÅŸ ve Kan</span>
                        </div>
                        <span class="room-badge">15</span>
                    </li>
                    <li class="room-item" data-room="lannister">
                        <span class="room-icon">ğŸ¦</span>
                        <div class="room-info">
                            <span class="room-name">Lannister HayranlarÄ±</span>
                            <span class="room-desc">Bir Lannister borcunu Ã¶der</span>
                        </div>
                        <span class="room-badge">6</span>
                    </li>
                </ul>
            </div>

            <!-- Online Users -->
            <div class="online-users">
                <h3 class="sidebar-section-title">
                    Ã‡evrimiÃ§i KullanÄ±cÄ±lar
                    <span class="online-count">18</span>
                </h3>
                <ul class="user-list" id="onlineUsers">
                    <li class="user-item">
                        <span class="user-status online"></span>
                        <span class="user-avatar-small">ğŸº</span>
                        <span class="user-name">WinterIsComing</span>
                    </li>
                    <li class="user-item">
                        <span class="user-status online"></span>
                        <span class="user-avatar-small">ğŸ‰</span>
                        <span class="user-name">DragonQueen</span>
                    </li>
                    <li class="user-item">
                        <span class="user-status online"></span>
                        <span class="user-avatar-small">ğŸ¦</span>
                        <span class="user-name">GoldenLion</span>
                    </li>
                    <li class="user-item">
                        <span class="user-status away"></span>
                        <span class="user-avatar-small">ğŸ—¡ï¸</span>
                        <span class="user-name">NeedleArya</span>
                    </li>
                    <li class="user-item">
                        <span class="user-status online"></span>
                        <span class="user-avatar-small">ğŸ“š</span>
                        <span class="user-name">TyrionBooks</span>
                    </li>
                </ul>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <section class="chat-main">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="chat-room-info">
                    <span class="room-icon-large">ğŸ°</span>
                    <div>
                        <h2 class="current-room-name">Genel Sohbet</h2>
                        <p class="current-room-desc">Herkesin katÄ±labileceÄŸi ana oda â€¢ 24 kullanÄ±cÄ± Ã§evrimiÃ§i</p>
                    </div>
                </div>
                <div class="chat-actions">
                    <button class="chat-action-btn" title="Oda AyarlarÄ±">âš™ï¸</button>
                    <button class="chat-action-btn" title="KullanÄ±cÄ± Listesi" id="toggleUserList">ğŸ‘¥</button>
                    <button class="chat-action-btn" title="Bildirimler">ğŸ””</button>
                </div>
            </div>

            <!-- Messages Area -->
            <div class="chat-messages" id="chatMessages">
                <!-- System Message -->
                <div class="message system-message">
                    <p>ğŸ° <strong>Genel Sohbet</strong> odasÄ±na hoÅŸ geldiniz! LÃ¼tfen topluluk kurallarÄ±na uyun.</p>
                </div>

                <!-- Date Divider -->
                <div class="date-divider">
                    <span>BugÃ¼n</span>
                </div>

                <!-- Sample Messages -->
                <div class="message">
                    <div class="message-avatar">
                        <span>ğŸº</span>
                    </div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-author stark-user">WinterIsComing</span>
                            <span class="message-time">14:32</span>
                        </div>
                        <p class="message-text">Merhaba arkadaÅŸlar! Jon Snow'un gerÃ§ek kimliÄŸi hakkÄ±nda ne dÃ¼ÅŸÃ¼nÃ¼yorsunuz?</p>
                    </div>
                </div>

                <div class="message">
                    <div class="message-avatar">
                        <span>ğŸ‰</span>
                    </div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-author targaryen-user">DragonQueen</span>
                            <span class="message-time">14:35</span>
                        </div>
                        <p class="message-text">Aegon Targaryen! Lyanna ve Rhaegar'Ä±n oÄŸlu. Demir Taht'Ä±n gerÃ§ek varisi ğŸ‘‘</p>
                    </div>
                </div>

                <div class="message">
                    <div class="message-avatar">
                        <span>ğŸ¦</span>
                    </div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-author lannister-user">GoldenLion</span>
                            <span class="message-time">14:38</span>
                        </div>
                        <p class="message-text">Taht oyunlarÄ±nda Ã¶nemli olan soy deÄŸil, gÃ¼Ã§tÃ¼r. Cersei'nin dediÄŸi gibi: "Taht oyunlarÄ±nda ya kazanÄ±rsÄ±n ya Ã¶lÃ¼rsÃ¼n." âš”ï¸</p>
                    </div>
                </div>

                <div class="message">
                    <div class="message-avatar">
                        <span>ğŸ—¡ï¸</span>
                    </div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-author">NeedleArya</span>
                            <span class="message-time">14:42</span>
                        </div>
                        <p class="message-text">Arya'nÄ±n Gece KralÄ±'nÄ± Ã¶ldÃ¼rmesi en epic sahneydi! ğŸ—¡ï¸ğŸ’¨</p>
                        <div class="message-reactions">
                            <span class="reaction">â¤ï¸ 5</span>
                            <span class="reaction">ğŸ”¥ 3</span>
                            <span class="reaction">âš”ï¸ 2</span>
                        </div>
                    </div>
                </div>

                <div class="message">
                    <div class="message-avatar">
                        <span>ğŸ“š</span>
                    </div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="message-author">TyrionBooks</span>
                            <span class="message-time">14:45</span>
                        </div>
                        <p class="message-text">Kitaplardaki hikaye Ã§ok farklÄ±. George R.R. Martin'in yeni kitabÄ±nÄ± bekliyorum hala... ğŸ“–</p>
                    </div>
                </div>

                <div class="message typing-indicator" id="typingIndicator" style="display: none;">
                    <div class="message-avatar">
                        <span>ğŸ‘¤</span>
                    </div>
                    <div class="message-content">
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Message Input -->
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <button class="input-action-btn" title="Emoji">ğŸ˜Š</button>
                    <button class="input-action-btn" title="Dosya Ekle">ğŸ“</button>
                    <button class="input-action-btn" title="GIF">ğŸ¬</button>
                    <input 
                        type="text" 
                        class="chat-input" 
                        id="messageInput" 
                        placeholder="MesajÄ±nÄ±zÄ± yazÄ±n..."
                        autocomplete="off"
                    >
                    <button class="send-btn" id="sendBtn" title="GÃ¶nder">
                        <span>ğŸ“¤</span>
                    </button>
                </div>
                <p class="input-hint">Enter tuÅŸuna basarak gÃ¶nderin â€¢ Shift+Enter ile yeni satÄ±r</p>
            </div>
        </section>

        <!-- User Profile Panel (Hidden by default) -->
        <aside class="user-profile-panel" id="userProfilePanel">
            <div class="profile-header">
                <button class="close-panel-btn" id="closeProfile">âœ•</button>
                <div class="profile-avatar-large">ğŸº</div>
                <h3 class="profile-name">WinterIsComing</h3>
                <p class="profile-title">Kuzey'in Koruyucusu</p>
            </div>
            <div class="profile-info">
                <div class="info-item">
                    <span class="info-label">Favori Hane</span>
                    <span class="info-value">ğŸº Stark</span>
                </div>
                <div class="info-item">
                    <span class="info-label">KatÄ±lÄ±m Tarihi</span>
                    <span class="info-value">Ocak 2026</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Mesaj SayÄ±sÄ±</span>
                    <span class="info-value">1,247</span>
                </div>
            </div>
            <div class="profile-actions">
                <button class="btn btn-outline btn-sm">Mesaj GÃ¶nder</button>
                <button class="btn btn-outline btn-sm">Profili GÃ¶rÃ¼ntÃ¼le</button>
            </div>
        </aside>
    </main>

    <!-- Login Required Modal (for non-authenticated users) -->
    <div class="modal" id="loginModal" th:unless="${currentUser}">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-icon">ğŸ”</span>
                <h2>GiriÅŸ YapmanÄ±z Gerekiyor</h2>
            </div>
            <p class="modal-text">Sohbet odasÄ±na katÄ±lmak iÃ§in lÃ¼tfen giriÅŸ yapÄ±n veya kayÄ±t olun.</p>
            <div class="modal-actions">
                <a href="login.html" class="btn btn-primary">GiriÅŸ Yap</a>
                <a href="register.html" class="btn btn-outline">KayÄ±t Ol</a>
            </div>
        </div>
    </div>

    <script src="../static/chat.js"></script>
    <script src="../static/chatbot.js"></script>
</body>
</html>
